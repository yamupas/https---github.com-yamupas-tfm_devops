{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{\"2grs\":function(module,__webpack_exports__,__webpack_require__){\"use strict\";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,\"UserModule\",(function(){return users_module_UserModule}));var shared_module=__webpack_require__(\"PCNd\"),router=__webpack_require__(\"tyNb\"),dialog=__webpack_require__(\"0IaG\"),fesm2015_forms=__webpack_require__(\"3Pt+\"),environment=__webpack_require__(\"AytR\"),core=__webpack_require__(\"fXoL\"),flex=__webpack_require__(\"XiUz\"),form_field=__webpack_require__(\"kmnG\"),input=__webpack_require__(\"qFsG\"),common=__webpack_require__(\"ofXK\"),fesm2015_checkbox=__webpack_require__(\"bSwM\"),fesm2015_button=__webpack_require__(\"bTqV\");const _c0=[\"class\",\"component\"];function UserDialogComponent_mat_error_11_Template(rf,ctx){1&rf&&(core.Zb(0,\"mat-error\"),core.Nc(1,\"ingrese un nombre \"),core.Yb())}function UserDialogComponent_mat_error_17_Template(rf,ctx){1&rf&&(core.Zb(0,\"mat-error\"),core.Nc(1,\"usuario de red \"),core.Yb())}function UserDialogComponent_mat_error_23_Template(rf,ctx){1&rf&&(core.Zb(0,\"mat-error\"),core.Nc(1,\"ingrese un nombre \"),core.Yb())}function UserDialogComponent_mat_checkbox_33_Template(rf,ctx){if(1&rf){const _r6=core.ac();core.Zb(0,\"mat-checkbox\",14),core.hc(\"change\",(function($event){core.Dc(_r6);const data_r4=ctx.$implicit;return core.lc().onChange(data_r4.id,$event.checked)})),core.Nc(1),core.Yb()}if(2&rf){const data_r4=ctx.$implicit,ctx_r3=core.lc();core.sc(\"value\",data_r4.id),core.sc(\"id\",data_r4.id),core.rc(\"checked\",ctx_r3.chekedRole(data_r4)),core.Fb(1),core.Oc(data_r4.normalizedName)}}let dialog_user_component_UserDialogComponent=(()=>{class UserDialogComponent{constructor(dialogRef,data,fb){this.dialogRef=dialogRef,this.data=data,this.fb=fb,this.vData={},this.rolesData=[],this.vData=this.data.users,this.rolesData=this.data.roles,console.log(this.rolesData),this.formRegister=this.fb.group({id:\"\",applicationId:environment.a.aplicationId,fullName:[null,fesm2015_forms.w.compose([fesm2015_forms.w.required,fesm2015_forms.w.minLength(6)])],email:[null],userName:[null,fesm2015_forms.w.compose([fesm2015_forms.w.required,fesm2015_forms.w.minLength(3)])],lockoutEnabled:[!1],roles:this.fb.array([])}),this.setUserData()}cancel(){this.dialogRef.close(!1)}setUserData(){try{if(null!=this.vData){let data=this.data.users;this.formRegister.controls.userName.setValue(data.userName),this.formRegister.controls.applicationId.setValue(environment.a.aplicationId),this.formRegister.controls.id.setValue(data.id),this.formRegister.controls.fullName.setValue(data.fullName),this.formRegister.controls.email.setValue(data.email),this.formRegister.controls.lockoutEnabled.setValue(data.lockoutEnabled),null!=data.roles&&data.roles.length&&data.roles.forEach(element=>{this.onChange(element.id,!0)})}}catch(error){}}onChange(email,isChecked){const emailFormArray=this.formRegister.controls.roles;if(isChecked)emailFormArray.push(new fesm2015_forms.f(email));else{let index=emailFormArray.controls.findIndex(x=>x.value==email);emailFormArray.removeAt(index)}}chekedRole(role){try{if(null!=this.data.users&&null!=this.data.users){const result=this.data.users.roles.filter(word=>word.id==role.id);return null!=result&&result.length>0}}catch(error){return!1}}}return UserDialogComponent.ɵfac=function(t){return new(t||UserDialogComponent)(core.Tb(dialog.g),core.Tb(dialog.a),core.Tb(fesm2015_forms.e))},UserDialogComponent.ɵcmp=core.Nb({type:UserDialogComponent,selectors:[[\"ngx-dialog-maquinas-confirm\",8,\"component\"]],attrs:_c0,decls:39,vars:7,consts:[[\"mat-dialog-title\",\"\"],[\"fxLayout\",\"row wrap\",1,\"matero-row\"],[1,\"form-field-full\",3,\"formGroup\"],[\"fxLayout\",\"row wrap\",\"fxLayoutGap\",\"8px grid\"],[\"fxFlex\",\"50\",\"fxFlex.lt-md\",\"100\"],[\"matInput\",\"\",\"placeholder\",\"Código SAP\",\"formControlName\",\"fullName\",\"maxlength\",\"300\",\"required\",\"\"],[4,\"ngIf\"],[\"matInput\",\"\",\"placeholder\",\"Código SAP\",\"formControlName\",\"userName\",\"maxlength\",\"300\",\"required\",\"\"],[\"matInput\",\"\",\"placeholder\",\"Correo Electronico\",\"formControlName\",\"email\",\"maxlength\",\"300\",\"required\",\"\"],[\"fxFlex\",\"50\",\"fxFlex.lt-sm\",\"100\"],[\"id\",\"amateur\",\"color\",\"primary\",\"formControlName\",\"lockoutEnabled\",1,\"amateur\"],[\"id\",\"amateur\",3,\"checked\",\"value\",\"id\",\"change\",4,\"ngFor\",\"ngForOf\"],[\"mat-raised-button\",\"\",\"mat-dialog-close\",\"\",3,\"click\"],[\"mat-raised-button\",\"\",\"color\",\"primary\",\"mat-dialog-close\",\"\",\"cdkFocusInitial\",\"\",3,\"mat-dialog-close\",\"disabled\"],[\"id\",\"amateur\",3,\"checked\",\"value\",\"id\",\"change\"]],template:function(rf,ctx){1&rf&&(core.Zb(0,\"h2\",0),core.Nc(1,\"Crear o editar usuario\"),core.Yb(),core.Zb(2,\"div\",1),core.Zb(3,\"mat-dialog-content\"),core.Zb(4,\"form\",2),core.Zb(5,\"div\",3),core.Zb(6,\"div\",4),core.Zb(7,\"mat-form-field\"),core.Zb(8,\"mat-label\"),core.Nc(9,\"Nombre Completo\"),core.Yb(),core.Ub(10,\"input\",5),core.Lc(11,UserDialogComponent_mat_error_11_Template,2,0,\"mat-error\",6),core.Yb(),core.Yb(),core.Zb(12,\"div\",4),core.Zb(13,\"mat-form-field\"),core.Zb(14,\"mat-label\"),core.Nc(15,\"Usuario de Red\"),core.Yb(),core.Ub(16,\"input\",7),core.Lc(17,UserDialogComponent_mat_error_17_Template,2,0,\"mat-error\",6),core.Yb(),core.Yb(),core.Zb(18,\"div\",4),core.Zb(19,\"mat-form-field\"),core.Zb(20,\"mat-label\"),core.Nc(21,\"Correo Electronico\"),core.Yb(),core.Ub(22,\"input\",8),core.Lc(23,UserDialogComponent_mat_error_23_Template,2,0,\"mat-error\",6),core.Yb(),core.Yb(),core.Zb(24,\"div\",9),core.Ub(25,\"br\"),core.Zb(26,\"mat-checkbox\",10),core.Nc(27,\"Cuenta deshabilitada?\"),core.Yb(),core.Yb(),core.Zb(28,\"div\",9),core.Ub(29,\"br\"),core.Zb(30,\"mat-label\"),core.Nc(31,\"Roles de usuario\"),core.Yb(),core.Ub(32,\"br\"),core.Lc(33,UserDialogComponent_mat_checkbox_33_Template,2,4,\"mat-checkbox\",11),core.Yb(),core.Yb(),core.Yb(),core.Yb(),core.Zb(34,\"mat-dialog-actions\"),core.Zb(35,\"button\",12),core.hc(\"click\",(function(){return ctx.cancel()})),core.Nc(36,\"Cancelar\"),core.Yb(),core.Zb(37,\"button\",13),core.Nc(38,\"Aceptar\"),core.Yb(),core.Yb(),core.Yb()),2&rf&&(core.Fb(4),core.rc(\"formGroup\",ctx.formRegister),core.Fb(7),core.rc(\"ngIf\",ctx.formRegister.get(\"fullName\").invalid),core.Fb(6),core.rc(\"ngIf\",ctx.formRegister.get(\"userName\").invalid),core.Fb(6),core.rc(\"ngIf\",ctx.formRegister.get(\"email\").invalid),core.Fb(10),core.rc(\"ngForOf\",ctx.rolesData),core.Fb(4),core.rc(\"mat-dialog-close\",ctx.formRegister.value)(\"disabled\",!ctx.formRegister.valid))},directives:[dialog.h,flex.c,dialog.e,fesm2015_forms.x,fesm2015_forms.q,fesm2015_forms.j,flex.d,flex.a,form_field.c,form_field.g,input.b,fesm2015_forms.c,fesm2015_forms.p,fesm2015_forms.h,fesm2015_forms.l,fesm2015_forms.v,common.n,fesm2015_checkbox.a,common.m,dialog.c,fesm2015_button.b,dialog.d,form_field.b],styles:[\"table[_ngcontent-%COMP%]{width:100%}.example-section[_ngcontent-%COMP%]{margin:12px 0}.example-margin[_ngcontent-%COMP%]{margin:0 12px}ul[_ngcontent-%COMP%]{list-style-type:none;margin-top:4px}\"]}),UserDialogComponent})();var table=__webpack_require__(\"+0xr\"),takeWhile=__webpack_require__(\"GJmQ\"),app_core=__webpack_require__(\"ey9i\"),shared=__webpack_require__(\"M0ag\"),ngx_toastr=__webpack_require__(\"5eHb\"),page_header_component=__webpack_require__(\"tgey\"),mtxGrid=__webpack_require__(\"hGDI\");const users_component_c0=function(){return[5,10,20]};let users_component_UsersComponent=(()=>{class UsersComponent{constructor(_usersService,_router,dialog,_toastrService,pagerService,cdr){this._usersService=_usersService,this._router=_router,this.dialog=dialog,this._toastrService=_toastrService,this.pagerService=pagerService,this.cdr=cdr,this.isAuthenticated=!1,this.ListRoles=[],this.columns=[{header:\"Nombre\",field:\"fullName\"},{header:\"Usuario\",field:\"userName\"},{header:\"Correo\",field:\"email\"},{header:\"Opción\",field:\"option\",width:\"120px\",pinned:\"right\",right:\"0px\",type:\"button\",buttons:[{icon:\"edit\",tooltip:\"Editar\",type:\"icon\",click:record=>this.editUser(record)}]}],this.alive=!0,this.list=[],this.total=0,this.isLoading=!0,this.query={q:\"\",sort:\"stars\",order:\"desc\",page:0,per_page:10},this.isAuthenticated=!0,this.GetAllUserList(),this.GetAllRolesList()}ngOnInit(){}GetAllUserList(){try{this._usersService.get(\"api/users/getall/\"+environment.a.aplicationId).pipe(Object(takeWhile.a)(()=>this.alive)).subscribe(data=>{this.ListUsers=new table.o(data.body),this.ListUsers=data.body,this.ListUsersdatasearch=data.body,this.total=this.ListUsers.length,this.setpage(),this.isLoading=!1,this.cdr.detectChanges()})}catch(error){}}GetAllRolesList(){try{this._usersService.get(\"api/users/GetAllByApplication/\"+environment.a.aplicationId).pipe(Object(takeWhile.a)(()=>this.alive)).subscribe(data=>{this.ListRoles=data.body})}catch(error){}}get params(){const p=Object.assign({},this.query);return p.page+=1,Object(shared.a)(p)}getNextPage(e){this.query.page=e.pageIndex,this.query.per_page=e.pageSize,this.setpage()}search(){let searchText=this.query.q.toLocaleLowerCase();this.ListUsersdatasearch=this.ListUsers.filter(it=>it.fullName.toLocaleLowerCase().includes(searchText)),this.query.page=0,this.setpage()}setpage(){let pager=this.pagerService.getPager(this.ListUsersdatasearch.length,this.query.page+1,this.query.per_page);this.list=this.ListUsersdatasearch.slice(pager.startIndex,pager.endIndex+1)}editUser(_model){console.log(this.ListRoles),this.dialog.open(dialog_user_component_UserDialogComponent,{width:\"900px\",data:{users:_model,roles:this.ListRoles},panelClass:\"ModalPanelClass\",closeOnNavigation:!1,disableClose:!0}).afterClosed().subscribe(result=>{console.log(result),result&&(null!=_model?(result.id=_model.id,this.updateUser(result)):this.AddUser(result))})}updateUser(result){try{this._usersService.post(\"api/users/update\",result).pipe(Object(takeWhile.a)(()=>this.alive)).subscribe(rutas=>{200==rutas.status&&this.GetAllUserList()},error=>{})}catch(error){console.log(error)}}AddUser(result){try{this._usersService.post(\"api/users/save\",result).pipe(Object(takeWhile.a)(()=>this.alive)).subscribe(rutas=>{200==rutas.status?(this.GetAllUserList(),this._toastrService.success(\"datos guardados correctamente\")):this._toastrService.error(\"error\",403==rutas.status?\"No tienes permiso para realizar esta accion\":\"error al guardar intente mas tarde\")},error=>{})}catch(error){console.log(error)}}}return UsersComponent.ɵfac=function(t){return new(t||UsersComponent)(core.Tb(app_core.j),core.Tb(router.f),core.Tb(dialog.b),core.Tb(ngx_toastr.b),core.Tb(app_core.f),core.Tb(core.h))},UsersComponent.ɵcmp=core.Nb({type:UsersComponent,selectors:[[\"ngx-users-table\"]],decls:9,vars:10,consts:[[1,\"bg-blue-600\"],[1,\"m-r-8\"],[\"matInput\",\"\",\"name\",\"q\",\"placeholder\",\"Buscar por nombre\",3,\"ngModel\",\"ngModelChange\"],[\"mat-raised-button\",\"\",\"color\",\"primary\",1,\"m-r-8\",3,\"click\"],[3,\"data\",\"columns\",\"length\",\"loading\",\"pageOnFront\",\"pageIndex\",\"pageSize\",\"pageSizeOptions\",\"page\"]],template:function(rf,ctx){1&rf&&(core.Ub(0,\"page-header\",0),core.Zb(1,\"form\"),core.Zb(2,\"mat-form-field\",1),core.Zb(3,\"input\",2),core.hc(\"ngModelChange\",(function($event){return ctx.query.q=$event})),core.Yb(),core.Yb(),core.Zb(4,\"button\",3),core.hc(\"click\",(function(){return ctx.search()})),core.Nc(5,\"Buscar\"),core.Yb(),core.Zb(6,\"button\",3),core.hc(\"click\",(function(){return ctx.editUser(null)})),core.Nc(7,\"Crear\"),core.Yb(),core.Yb(),core.Zb(8,\"mtx-grid\",4),core.hc(\"page\",(function($event){return ctx.getNextPage($event)})),core.Yb()),2&rf&&(core.Fb(3),core.rc(\"ngModel\",ctx.query.q),core.Fb(5),core.rc(\"data\",ctx.list)(\"columns\",ctx.columns)(\"length\",ctx.total)(\"loading\",ctx.isLoading)(\"pageOnFront\",!1)(\"pageIndex\",ctx.query.page)(\"pageSize\",ctx.query.per_page)(\"pageSizeOptions\",core.tc(9,users_component_c0)))},directives:[page_header_component.a,fesm2015_forms.x,fesm2015_forms.q,fesm2015_forms.r,form_field.c,input.b,fesm2015_forms.c,fesm2015_forms.p,fesm2015_forms.s,fesm2015_button.b,mtxGrid.a],styles:[\"table[_ngcontent-%COMP%]{width:100%}\"]}),UsersComponent})();const routes=[{path:\"\",component:users_component_UsersComponent},{path:\"list\",component:users_component_UsersComponent,data:{title:\"Usuarios\"}}];let users_routing_module_UsersRoutingModule=(()=>{class UsersRoutingModule{}return UsersRoutingModule.ɵmod=core.Rb({type:UsersRoutingModule}),UsersRoutingModule.ɵinj=core.Qb({factory:function(t){return new(t||UsersRoutingModule)},imports:[[router.j.forChild(routes)],router.j]}),UsersRoutingModule})(),users_module_UserModule=(()=>{class UserModule{}return UserModule.ɵmod=core.Rb({type:UserModule}),UserModule.ɵinj=core.Qb({factory:function(t){return new(t||UserModule)},imports:[[shared_module.a,users_routing_module_UsersRoutingModule]]}),UserModule})()}}]);","extractedComments":[]}